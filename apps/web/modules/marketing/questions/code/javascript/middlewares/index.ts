// JS Starter Code
const jsStarterCode = "/**\n * @param {...Function} fns\n * @returns {Function}\n */\nexport default function middlewares(...fns) {\n  throw \"Not implemented!\";\n}\n";

// TS Starter Code
const tsStarterCode = "type MiddlewareFn =\n  | ((context: any, next: () => Promise<void>) => Promise<void>)\n  | ((context: any, next: () => Promise<void>) => void);\n\nexport default function middlewares(\n  ...fns: Array<MiddlewareFn>\n): (context?: any) => Promise<void> {\n  throw \"Not implemented!\";\n}\n";

// JS Test Cases
const jsTestCode = "import middlewares from \"./middlewares\";\n\nasync function sleep(duration: number): Promise<void> {\n  return new Promise((resolve) => setTimeout(resolve, duration));\n}\n\ndescribe(\"middlewares\", () => {\n  describe(\"return values\", () => {\n    test(\"returns a function\", () => {\n      const fn = middlewares();\n      expect(typeof fn).toBe(\"function\");\n    });\n\n    test(\"returns a function that returns a promise\", () => {\n      const fn = middlewares();\n      const result = fn();\n      expect(result).toBeInstanceOf(Promise);\n      expect(typeof result.then).toBe(\"function\");\n      expect(typeof result.catch).toBe(\"function\");\n    });\n  });\n\n  test(\"no functions\", async () => {\n    const calls: string[] = [];\n\n    const fn = middlewares();\n\n    await fn({});\n    expect(calls).toEqual([]);\n  });\n\n  test(\"one function\", async () => {\n    const calls: string[] = [];\n\n    function f1(ctx: any, next: Function) {\n      calls.push(\"f1-start\");\n      next();\n      calls.push(\"f1-end\");\n    }\n\n    const fn = middlewares(f1);\n\n    await fn({});\n    expect(calls).toEqual([\"f1-start\", \"f1-end\"]);\n  });\n\n  describe(\"two functions\", () => {\n    test(\"synchronous\", async () => {\n      const calls: string[] = [];\n\n      function f1(ctx: any, next: Function) {\n        calls.push(\"f1-start\");\n        next();\n        calls.push(\"f1-end\");\n      }\n\n      function f2(ctx: any, next: Function) {\n        calls.push(\"f2-start\");\n        next();\n        calls.push(\"f2-end\");\n      }\n\n      const fn = middlewares(f1, f2);\n\n      await fn({});\n      expect(calls).toEqual([\"f1-start\", \"f2-start\", \"f2-end\", \"f1-end\"]);\n    });\n\n    test(\"asynchronous\", async () => {\n      const calls: string[] = [];\n\n      async function f1(ctx: any, next: Function) {\n        calls.push(\"f1-start\");\n        await next();\n        calls.push(\"f1-end\");\n      }\n\n      async function f2(ctx: any, next: Function) {\n        calls.push(\"f2-start\");\n        sleep(300);\n        await next();\n        calls.push(\"f2-end\");\n      }\n\n      const fn = middlewares(f1, f2);\n\n      await fn({});\n      expect(calls).toEqual([\"f1-start\", \"f2-start\", \"f2-end\", \"f1-end\"]);\n    });\n  });\n\n  describe(\"three functions\", () => {\n    test(\"synchronous\", async () => {\n      const calls: string[] = [];\n\n      function f1(ctx: any, next: Function) {\n        calls.push(\"f1-start\");\n        next();\n        calls.push(\"f1-end\");\n      }\n\n      function f2(ctx: any, next: Function) {\n        calls.push(\"f2-start\");\n        next();\n        calls.push(\"f2-end\");\n      }\n\n      function f3(ctx: any, next: Function) {\n        calls.push(\"f3-start\");\n        next();\n        calls.push(\"f3-end\");\n      }\n\n      const fn = middlewares(f1, f2, f3);\n\n      await fn({});\n      expect(calls).toEqual([\n        \"f1-start\",\n        \"f2-start\",\n        \"f3-start\",\n        \"f3-end\",\n        \"f2-end\",\n        \"f1-end\",\n      ]);\n    });\n\n    test(\"asynchronous\", async () => {\n      const calls: string[] = [];\n\n      async function f1(ctx: any, next: Function) {\n        calls.push(\"f1-start\");\n        await next();\n        calls.push(\"f1-end\");\n      }\n\n      async function f2(ctx: any, next: Function) {\n        calls.push(\"f2-start\");\n        sleep(300);\n        await next();\n        calls.push(\"f2-end\");\n      }\n\n      async function f3(ctx: any, next: Function) {\n        calls.push(\"f3-start\");\n        await next();\n        calls.push(\"f3-end\");\n      }\n\n      const fn = middlewares(f1, f2, f3);\n\n      await fn({});\n      expect(calls).toEqual([\n        \"f1-start\",\n        \"f2-start\",\n        \"f3-start\",\n        \"f3-end\",\n        \"f2-end\",\n        \"f1-end\",\n      ]);\n    });\n\n    test(\"middle function sync\", async () => {\n      const calls: string[] = [];\n\n      async function f1(ctx: any, next: Function) {\n        calls.push(\"f1-start\");\n        await next();\n        calls.push(\"f1-end\");\n      }\n\n      function f2(ctx: any, next: Function) {\n        calls.push(\"f2-start\");\n        return next().then(() => {\n          calls.push(\"f2-end\");\n        });\n      }\n\n      async function f3(ctx: any, next: Function) {\n        calls.push(\"f3-start\");\n        await next();\n        calls.push(\"f3-end\");\n      }\n\n      const fn = middlewares(f1, f2, f3);\n\n      await fn({});\n      expect(calls).toEqual([\n        \"f1-start\",\n        \"f2-start\",\n        \"f3-start\",\n        \"f3-end\",\n        \"f2-end\",\n        \"f1-end\",\n      ]);\n    });\n\n    test(\"last function sync\", async () => {\n      const calls: string[] = [];\n\n      async function f1(ctx: any, next: Function) {\n        calls.push(\"f1-start\");\n        await next();\n        calls.push(\"f1-end\");\n      }\n\n      async function f2(ctx: any, next: Function) {\n        calls.push(\"f2-start\");\n        sleep(300);\n        await next();\n        calls.push(\"f2-end\");\n      }\n\n      function f3(ctx: any, next: Function) {\n        calls.push(\"f3-start\");\n        next();\n        calls.push(\"f3-end\");\n      }\n\n      const fn = middlewares(f1, f2, f3);\n\n      await fn({});\n      expect(calls).toEqual([\n        \"f1-start\",\n        \"f2-start\",\n        \"f3-start\",\n        \"f3-end\",\n        \"f2-end\",\n        \"f1-end\",\n      ]);\n    });\n  });\n\n  test(\"does not call next()\", async () => {\n    const calls: string[] = [];\n\n    async function f1(ctx: any, next: Function) {\n      calls.push(\"f1-start\");\n      await next();\n      calls.push(\"f1-end\");\n    }\n\n    async function f2(ctx: any, next: Function) {\n      calls.push(\"f2-start\");\n      calls.push(\"f2-end\");\n    }\n\n    function f3(ctx: any, next: Function) {\n      calls.push(\"f3-start\");\n      next();\n      calls.push(\"f3-end\");\n    }\n\n    const fn = middlewares(f1, f2, f3);\n\n    await fn({});\n    expect(calls).toEqual([\"f1-start\", \"f2-start\", \"f2-end\", \"f1-end\"]);\n  });\n\n  test(\"context is passed\", async () => {\n    async function f1(ctx: any, next: Function) {\n      ctx.push(\"f1-start\");\n      await next();\n      ctx.push(\"f1-end\");\n    }\n\n    async function f2(ctx: any, next: Function) {\n      ctx.push(\"f2-start\");\n      await next();\n      ctx.push(\"f2-end\");\n    }\n\n    function f3(ctx: any, next: Function) {\n      ctx.push(\"f3-start\");\n      next();\n      ctx.push(\"f3-end\");\n    }\n\n    const fn = middlewares(f1, f2, f3);\n\n    const context: string[] = [];\n    await fn(context);\n\n    expect(context).toEqual([\n      \"f1-start\",\n      \"f2-start\",\n      \"f3-start\",\n      \"f3-end\",\n      \"f2-end\",\n      \"f1-end\",\n    ]);\n  });\n\n  test(\"can be called multiple times\", async () => {\n    let count = 0;\n\n    async function f1(ctx: any, next: Function) {\n      count++;\n      ctx.push(\"f1-start\");\n      await next();\n      ctx.push(\"f1-end\");\n    }\n\n    async function f2(ctx: any, next: Function) {\n      count++;\n      ctx.push(\"f2-start\");\n      await next();\n      ctx.push(\"f2-end\");\n    }\n\n    function f3(ctx: any, next: Function) {\n      count++;\n      ctx.push(\"f3-start\");\n      next();\n      ctx.push(\"f3-end\");\n    }\n\n    const fn = middlewares(f1, f2, f3);\n\n    const context1: string[] = [];\n    const context2: string[] = [];\n\n    await Promise.all([fn(context1), fn(context2)]);\n\n    expect(context1).toEqual([\n      \"f1-start\",\n      \"f2-start\",\n      \"f3-start\",\n      \"f3-end\",\n      \"f2-end\",\n      \"f1-end\",\n    ]);\n    expect(context2).toEqual([\n      \"f1-start\",\n      \"f2-start\",\n      \"f3-start\",\n      \"f3-end\",\n      \"f2-end\",\n      \"f1-end\",\n    ]);\n    expect(count).toBe(6);\n  });\n});\n";

// TS Test Cases
const tsTestCode = jsTestCode; 

// JS Test File Name
const jsTestFileName = "submission.spec.ts";

// TS Test File Name
const tsTestFileName = "submission.spec.ts";
// Additional Files
const additionalFiles = {} as Record<string, string>;

const code = {
  jsStarterCode,
  tsStarterCode,
  jsTestCode,
  tsTestCode,
  jsTestFileName,
  tsTestFileName,
  additionalFiles,
} as Record<string, string | Record<string, string>>;

// Export the code object
export default code;
